/*! jQuery v2.0.0 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
 //@ sourceMappingURL=jquery.min.map
 */

/*!
 * AmplifyJS 1.1.0 - Core, Store, Request
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */

(function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function K(e,t){while((e=e[t])&&1!==e.nodeType);return e}function Z(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function ct(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function pt(e){var t=at.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function ht(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function dt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(q.hasData(e)&&(s=q.access(e),o=x.extend({},s),f=s.events,q.set(t,o),f)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function gt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function mt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&it.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function Dt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=jt.length;while(i--)if(t=jt[i]+n,t in e)return t;return r}function At(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function Lt(t){return e.getComputedStyle(t,null)}function qt(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=q.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&At(r)&&(s[o]=q.access(r,"olddisplay",Pt(r.nodeName)))):s[o]||(i=At(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ht(e,t,n){var r=wt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ot(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+St[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+St[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+St[s]+"Width",!0,i))):(o+=x.css(e,"padding"+St[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+St[s]+"Width",!0,i)));return o}function Ft(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=Lt(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=yt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Tt.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ot(e,t,n||(o?"border":"content"),r,s)+"px"}function Pt(e){var t=o,n=kt[e];return n||(n=Rt(e,t),"none"!==n&&n||(vt=(vt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(vt[0].contentWindow||vt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Rt(e,t),vt.detach()),kt[e]=n),n}function Rt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function zt(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||Wt.test(e)?r(e,i):zt(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)zt(e+"["+i+"]",t[i],n,r)}function an(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function un(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===rn;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ln(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function cn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function Nn(){return setTimeout(function(){vn=undefined}),vn=x.now()}function En(e,t){x.each(t,function(t,n){var r=(kn[t]||[]).concat(kn["*"]),i=0,s=r.length;for(;s>i;i++)if(r[i].call(e,t,n))return})}function Sn(e,t,n){var r,i,s=0,o=Cn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=vn||Nn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:vn||Nn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(jn(l,f.opts.specialEasing);o>s;s++)if(r=Cn[s].call(f,e,l,f.opts))return r;return En(f,l),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function jn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function Dn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&At(e);n.queue||(l=x._queueHooks(e,"fx"),null==l.unqueued&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,x.queue(e,"fx").length||l.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=q.get(e,"fxshow");for(r in t)if(s=t[r],bn.exec(s)){if(delete t[r],a=a||"toggle"===s,s===(m?"hide":"show")){if("show"!==s||u===undefined||u[r]===undefined)continue;m=!0}v.push(r)}if(o=v.length){u=q.get(e,"fxshow")||q.access(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?x(e).show():h.done(function(){x(e).hide()}),h.done(function(){var t;q.remove(e,"fxshow");for(t in d)x.style(e,t,d[t])});for(r=0;o>r;r++)i=v[r],f=h.createTween(i,m?u[i]:0),d[i]=u[i]||x.style(e,i),i in u||(u[i]=f.start,m&&(f.end=f.start,f.start="width"===i||"height"===i?1:0))}}function An(e,t,n,r,i){return new An.prototype.init(e,t,n,r,i)}function Ln(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=St[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function qn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],f="2.0.0",p=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=f.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:f,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return p.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function st(e){return G.test(e+"")}function ot(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ut(e){return e[y]=!0,e}function at(e){var t=c.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t,n,r){var i,s,o,u,a,f,h,v,m,E;if((t?t.ownerDocument||t:b)!==c&&l(t),t=t||c,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(p&&!r){if(i=Y.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&g(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return P.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&w.getElementsByClassName&&t.getElementsByClassName)return P.apply(n,t.getElementsByClassName(o)),n}if(w.qsa&&(!d||!d.test(e))){if(v=h=y,m=t,E=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=mt(e),(h=t.getAttribute("id"))?v=h.replace(tt,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",a=f.length;while(a--)f[a]=v+gt(f[a]);m=V.test(e)&&t.parentNode||t,E=f.join(",")}if(E)try{return P.apply(n,m.querySelectorAll(E)),n}catch(S){}finally{h||t.removeAttribute("id")}}}return Nt(e.replace(z,"$1"),t,n,r)}function lt(e,t){var n=t&&e,r=n&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}function ht(e,n,r){var i;return r?t:i=e.getAttribute(n,"type"===n.toLowerCase()?1:2)}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function dt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function vt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function mt(e,t){var n,r,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){(!n||(r=W.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(s=[])),n=!1,(r=X.exec(u))&&(n=r.shift(),s.push({value:n,type:r[0].replace(z," ")}),u=u.slice(n.length));for(o in i.filter)!(r=Q[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ft.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,s=n&&"parentNode"===i,o=S++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||s)return e(t,n,r)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[i])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[i])if(1===t.nodeType||s)if(l=t[y]||(t[y]={}),(f=l[i])&&f[0]===c){if((a=f[1])===!0||a===r)return a===!0}else if(f=l[i]=[c],f[1]=e(t,n,u)||r,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[y]&&(r=Et(r)),i&&!i[y]&&(i=Et(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function St(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],f=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return B.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==a)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;s>f;f++)if(n=i.relative[e[f].type])h=[yt(bt(h),n)];else{if(n=i.filter[e[f].type].apply(null,e[f].matches),n[y]){for(r=++f;s>r;r++)if(i.relative[e[r].type])break;return Et(f>1&&bt(h),f>1&&gt(e.slice(0,f-1)).replace(z,"$1"),n,r>f&&St(e.slice(f,r)),s>r&&St(e=e.slice(r)),s>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,s=t.length>0,o=e.length>0,u=function(u,f,l,h,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=a,T=u||o&&i.find.TAG("*",p&&f.parentNode||f),N=E+=null==x?1:Math.random()||.1;for(S&&(a=f!==c&&f,r=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,f,l)){h.push(d);break}S&&(E=N,r=++n)}s&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,s&&b!==y){v=0;while(m=t[v++])m(w,g,f,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=_.call(h));g=wt(g)}P.apply(h,g),S&&!u&&g.length>0&&y+t.length>1&&ft.uniqueSort(h)}return S&&(E=N,a=x),w};return s?ut(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ft(e,t[r],n);return n}function Nt(e,t,n,r){var s,o,a,f,l,c=mt(e);if(!r&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===t.nodeType&&p&&i.relative[o[1].type]){if(t=(i.find.ID(a.matches[0].replace(nt,rt),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}s=Q.needsContext.test(e)?0:o.length;while(s--){if(a=o[s],i.relative[f=a.type])break;if((l=i.find[f])&&(r=l(a.matches[0].replace(nt,rt),V.test(o[0].type)&&t.parentNode||t))){if(o.splice(s,1),e=r.length&&gt(o),!e)return P.apply(n,r),n;break}}}return u(e,c)(r,t,!p,n,V.test(e)),n}function Ct(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y="sizzle"+ -(new Date),b=e.document,w={},E=0,S=0,T=ot(),N=ot(),C=ot(),k=!1,L=function(){return 0},A=typeof t,O=1<<31,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=M.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="\\["+F+"*("+I+")"+F+"*(?:([*^$|!~]?=)"+F+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+q+")|)|)"+F+"*\\]",U=":("+I+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+R.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=RegExp("^"+F+"*,"+F+"*"),X=RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=RegExp(F+"*[+~]"),$=RegExp("="+F+"*([^\\]'\"]*)"+F+"*\\]","g"),J=RegExp(U),K=RegExp("^"+q+"$"),Q={ID:RegExp("^#("+I+")"),CLASS:RegExp("^\\.("+I+")"),TAG:RegExp("^("+I.replace("w","w*")+")"),ATTR:RegExp("^"+R),PSEUDO:RegExp("^"+U),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),"boolean":RegExp("^(?:"+j+")$","i"),needsContext:RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},G=/^[^{]+\{\s*\[native \w/,Y=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,rt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{P.apply(M=H.call(b.childNodes),b.childNodes),M[b.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}o=ft.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},l=ft.setDocument=function(e){var n=e?e.ownerDocument||e:b;return n!==c&&9===n.nodeType&&n.documentElement?(c=n,h=n.documentElement,p=!o(n),w.getElementsByTagName=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),w.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByClassName=at(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),w.sortDetached=at(function(e){return 1&e.compareDocumentPosition(c.createElement("div"))}),w.getById=at(function(e){return h.appendChild(e).id=y,!n.getElementsByName||!n.getElementsByName(y).length}),w.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&p){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=w.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},i.find.CLASS=w.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&p?n.getElementsByClassName(e):t},v=[],d=[],(w.qsa=st(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),at(function(e){var t=c.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(w.matchesSelector=st(m=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&at(function(e){w.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",U)}),d=d.length&&RegExp(d.join("|")),v=v.length&&RegExp(v.join("|")),g=st(h.contains)||h.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=h.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return r?1&r||!w.sortDetached&&t.compareDocumentPosition(e)===r?e===n||g(b,e)?-1:t===n||g(b,t)?1:f?B.call(f,e)-B.call(f,t):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:f?B.call(f,e)-B.call(f,t):0;if(s===o)return lt(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?lt(u[i],a[i]):u[i]===b?-1:a[i]===b?1:0},c):c},ft.matches=function(e,t){return ft(e,null,null,t)},ft.matchesSelector=function(e,t){if((e.ownerDocument||e)!==c&&l(e),t=t.replace($,"='$1']"),!(!w.matchesSelector||!p||v&&v.test(t)||d&&d.test(t)))try{var n=m.call(e,t);if(n||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return ft(t,c,null,[e]).length>0},ft.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},ft.attr=function(e,n){(e.ownerDocument||e)!==c&&l(e);var r=i.attrHandle[n.toLowerCase()],s=r&&r(e,n,!p);return s===t?w.attributes||!p?e.getAttribute(n):(s=e.getAttributeNode(n))&&s.specified?s.value:null:s},ft.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ft.uniqueSort=function(e){var t,n=[],r=0,i=0;if(k=!w.detectDuplicates,f=!w.sortStable&&e.slice(0),e.sort(L),k){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return e},s=ft.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},i=ft.selectors={cacheLength:50,createPseudo:ut,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ft.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ft.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&J.test(n)&&(t=mt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ft.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),b=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&b){l=m[y]||(m[y]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(b&&(f=(t[y]||(t[y]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(b&&((c[y]||(c[y]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ft.error("unsupported pseudo: "+e);return r[y]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=B.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ut(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[y]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return ft(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:ut(function(e){return K.test(e||"")||ft.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:vt(function(){return[0]}),last:vt(function(e,t){return[t-1]}),eq:vt(function(e,t,n){return[0>n?n+t:n]}),even:vt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:vt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:vt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:vt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=pt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=dt(n);u=ft.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[y]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},i.pseudos.nth=i.pseudos.eq,Ct.prototype=i.filters=i.pseudos,i.setFilters=new Ct,w.sortStable=y.split("").sort(L).join("")===y,l(),[0,0].sort(L),w.detectDuplicates=k,at(function(e){if(e.innerHTML="<a href='#'></a>","#"!==e.firstChild.getAttribute("href")){var t="type|href|height|width".split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=ht}}),at(function(e){if(null!=e.getAttribute("disabled")){var t=j.split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=ct}}),x.find=ft,x.expr=ft.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ft.uniqueSort,x.text=ft.getText,x.isXMLDoc=ft.isXML,x.contains=ft.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||n&&!a||(r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))this.cache[i]=t;else for(r in t)s[r]=t[r]},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){return t===undefined||t&&"string"==typeof t&&n===undefined?this.get(e,t):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i=this.key(e),s=this.cache[i];if(t===undefined)this.cache[i]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):t in s?r=[t]:(r=x.camelCase(t),r=r in s?[r]:r.match(w)||[]),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){delete this.cache[this.key(e)]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.substring(5)),P(i,r,o[r]));q.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),s.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=q.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var s,o=0,u=x(this),a=t,f=e.match(w)||[];while(s=f[o++])a=i?a:!u.hasClass(s),u[a?"addClass":"removeClass"](s)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i,s=x(this);1===this.nodeType&&(i=r?e.call(this,n,s.val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.boolean.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.boolean.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.boolean.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=q.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=q.hasData(e)&&q.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(q.get(u,"events")||{})[t.type]&&q.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(q.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return 3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=x.expr.match.needsContext,Q={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return t=this,this.pushStack(x(e).filter(function(){for(r=0;i>r;r++)if(x.contains(t[r],this))return!0}));for(n=[],r=0;i>r;r++)x.find(e,this[r],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(Z(this,e||[],!0))},filter:function(e){return this.pushStack(Z(this,e||[],!1))},is:function(e){return!!e&&("string"==typeof e?J.test(e)?x(e,this.context).index(this[0])>=0:x.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=J.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return K(e,"nextSibling")},prev:function(e){return K(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(Q[e]||x.unique(i),"p"===e[0]&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var et=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,tt=/<([\w:]+)/,nt=/<|&#?\w+;/,rt=/<(?:script|style|link)/i,it=/^(?:checkbox|radio)$/i,ot=/checked\s*(?:[^=]|=\s*.checked.)/i,st=/^$|\/(?:java|ecma)script/i,at=/^true\/(.*)/,ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,lt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};lt.optgroup=lt.option,lt.tbody=lt.tfoot=lt.colgroup=lt.caption=lt.col=lt.thead,lt.th=lt.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ct(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ct(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(gt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&ht(gt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(gt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!rt.test(e)&&!lt[(tt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(et,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(gt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=p.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,d=e[0],v=x.isFunction(d);if(v||!(1>=l||"string"!=typeof d||x.support.checkClone)&&ot.test(d))return this.each(function(r){var i=c.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(l&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(gt(r,"script"),ft),o=s.length;l>f;f++)u=r,f!==h&&(u=x.clone(u,!0,!0),o&&x.merge(s,gt(u,"script"))),t.call(this[f],u,f);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,pt),f=0;o>f;f++)u=s[f],st.test(u.type||"")&&!q.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(ut,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=gt(u),s=gt(e),r=0,i=s.length;i>r;r++)mt(s[r],o[r]);if(t)if(n)for(s=s||gt(e),o=o||gt(u),r=0,i=s.length;i>r;r++)dt(s[r],o[r]);else dt(e,u);return o=gt(u,"script"),o.length>0&&ht(o,!a&&gt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(nt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(tt.exec(i)||["",""])[1].toLowerCase(),u=lt[o]||lt._default,s.innerHTML=u[1]+i.replace(et,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.firstChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=gt(h.appendChild(i),"script"),a&&ht(s),n)){f=0;while(i=s[f++])st.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i=e.length,s=0,o=x.event.special;for(;i>s;s++){if(n=e[s],x.acceptData(n)&&(t=q.access(n)))for(r in t.events)o[r]?x.event.remove(n,r):x.removeEvent(n,r,t.handle);L.discard(n),q.discard(n)}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"text",async:!1,global:!1,success:x.globalEval})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var yt,vt,xt=/^(none|table(?!-c[ea]).+)/,bt=/^margin/,wt=RegExp("^("+b+")(.*)$","i"),Tt=RegExp("^("+b+")(?!px)[a-z%]+$","i"),Ct=RegExp("^([+-])=("+b+")","i"),kt={BODY:"block"},Nt={position:"absolute",visibility:"hidden",display:"block"},Et={letterSpacing:0,fontWeight:400},St=["Top","Right","Bottom","Left"],jt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=Lt(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return qt(this,!0)},hide:function(){return qt(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:At(this))?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=yt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=Dt(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=Ct.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=Dt(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=yt(e,t,r)),"normal"===i&&t in Et&&(i=Et[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),yt=function(e,t,n){var r,i,s,o=n||Lt(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Tt.test(u)&&bt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&xt.test(x.css(e,"display"))?x.swap(e,Nt,function(){return Ft(e,t,r)}):Ft(e,t,r):undefined},set:function(e,n,r){var i=r&&Lt(e);return Ht(e,n,r?Ot(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},yt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=yt(e,t),Tt.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+St[r]+t]=s[r]||s[r-2]||s[0];return i}},bt.test(e)||(x.cssHooks[e+t].set=Ht)});var Mt=/%20/g,Wt=/\[\]$/,$t=/\r?\n/g,Bt=/^(?:submit|button|image|reset|file)$/i,It=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&It.test(this.nodeName)&&!Bt.test(e)&&(this.checked||!it.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace($t,"\r\n")}}):{name:t.name,value:n.replace($t,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)zt(n,e[n],t,i);return r.join("&").replace(Mt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var _t,Xt,Ut=x.now(),Yt=/\?/,Vt=/#.*$/,Gt=/([?&])_=[^&]*/,Jt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Qt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Kt=/^(?:GET|HEAD)$/,Zt=/^\/\//,en=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,tn=x.fn.load,nn={},rn={},on="*/".concat("*");try{Xt=i.href}catch(sn){Xt=o.createElement("a"),Xt.href="",Xt=Xt.href}_t=en.exec(Xt.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&tn)return tn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Xt,type:"GET",isLocal:Qt.test(_t[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":on,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ln(ln(e,x.ajaxSettings),t):ln(x.ajaxSettings,e)},ajaxPrefilter:an(nn),ajaxTransport:an(rn),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=cn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Jt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Xt)+"").replace(Vt,"").replace(Zt,_t[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=en.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===_t[1]&&u[2]===_t[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(_t[3]||("http:"===_t[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),un(nn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Kt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Yt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Gt.test(r)?r.replace(Gt,"$1_="+Ut++):r+(Yt.test(r)?"&":"?")+"_="+Ut++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+on+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=un(rn,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var pn=[],hn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=pn.pop()||x.expando+"_"+Ut++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(hn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&hn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(hn,"$1"+i):t.jsonp!==!1&&(t.url+=(Yt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,pn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var dn=x.ajaxSettings.xhr(),gn={0:200,1223:204},mn=0,yn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in yn)yn[e]();yn=undefined}),x.support.cors=!!dn&&"withCredentials"in dn,x.support.ajax=dn=!!dn,x.ajaxTransport(function(e){var t;return x.support.cors||dn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete yn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(gn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=yn[s=mn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var vn,xn,bn=/^(?:toggle|show|hide)$/,wn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Tn=/queueHooks$/,Cn=[Dn],kn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=wn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){if(n=+s[2],r=s[3]||(x.cssNumber[e]?"":"px"),"px"!==r&&u){u=x.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,x.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&1!==a&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};x.Animation=x.extend(Sn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],kn[n]=kn[n]||[],kn[n].unshift(t)},prefilter:function(e,t){t?Cn.unshift(e):Cn.push(e)}}),x.Tween=An,An.prototype={constructor:An,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=An.propHooks[this.prop];return e&&e.get?e.get(this):An.propHooks._default.get(this)},run:function(e){var t,n=An.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):An.propHooks._default.set(this),this}},An.prototype.init.prototype=An.prototype,An.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},An.propHooks.scrollTop=An.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(Ln(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(At).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=Sn(this,x.extend({},e),s);o.finish=function(){t.stop(!0)},(i||q.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=q.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Tn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:Ln("show"),slideUp:Ln("hide"),slideToggle:Ln("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=An.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(vn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),vn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){xn||(xn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(xn),xn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=qn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=qn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window),define("class",["jquery"],function(e){var t={inherited:function(e){},created:function(){},prototype:{init:function(){},extend:function(t){var n=t.extended;e.extend(this,t),n&&n(this)},include:function(t){var n=t.included;e.extend(this.prototype,t),n&&n(this)}},create:function(){var e=Object.create(this);return e.parent=this,e.prototype=e.fn=Object.create(this.prototype),e.created(),this.inherited(e),e},init:function(){var e=Object.create(this.prototype);return e.parent=this,e.father=e.parent.parent.fn,e.init.apply(e,arguments),e},extend:function(t){var n=t.extended;e.extend(this,t),n&&n(this)},include:function(t){var n=t.included;e.extend(this.prototype,t),n&&n(this)}};return t}),define("layers/game_layer/inputs_engine",["jquery","class"],function(e,t){var n=t.create(),r=0;return n.extend({}),n.include({init:function(t){var n=this;n.layer=t,n.pressed_keys=[],n.pressed_buttons=[],n.mouse_move={x:0,y:0},n.mouse_position={x:t.game.canvas.width/2,y:t.game.canvas.height/2},n.mouse_position_scr={x:t.game.canvas.width/2,y:t.game.canvas.height/2},e("body").keydown(function(t){e.inArray(t.keyCode,n.pressed_keys)==-1&&n.pressed_keys.push(t.keyCode);if(t.keyCode==8)return!1}),e("body").keyup(function(e){n.pressed_keys.push(e.keyCode);var t=[];for(var r in n.pressed_keys)n.pressed_keys[r]!=e.keyCode&&t.push(n.pressed_keys[r]);n.pressed_keys=t;if(e.keyCode==8)return!1}),e(t.game.canvas).mousedown(function(t){e.inArray(t.which,n.pressed_buttons)==-1&&n.pressed_buttons.push(t.which)}),e(t.game.canvas).mouseup(function(e){var t=[];for(var r in n.pressed_buttons)n.pressed_buttons[r]!=e.which&&t.push(n.pressed_buttons[r]);n.pressed_buttons=t}),n.lockMouse(),e(t.game.canvas).click(function(){n.requestLocks()}),n.mouseWheel()},keyPressed:function(e){var t=this,n=!1;for(var r in t.pressed_keys)t.pressed_keys[r]==e&&(n=!0);return n},buttonPressed:function(e){var t=this,n=!1;for(var r in t.pressed_buttons)t.pressed_buttons[r]==e&&(n=!0);return n},getScroll:function(){return r},MouseWheelHandler:function(){var e=this,t=window.event||t,n=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));r+=n},mouseWheel:function(){var t=this,n=e("body")[0];n.addEventListener?(n.addEventListener("mousewheel",t.MouseWheelHandler,!1),n.addEventListener("DOMMouseScroll",t.MouseWheelHandler,!1)):n.attachEvent&&n.attachEvent("onmousewheel",t.MouseWheelHandler)},run:function(){var e=this,t=e.layer.camera;e.mouse_position={x:e.mouse_position_scr.x/e.layer.camera.zoom+t.x,y:e.mouse_position_scr.y/e.layer.camera.zoom+t.y}},fullscreenChange:function(){var e=this,t=e.layer.game.canvas;if(document.webkitFullscreenElement===t||document.mozFullscreenElement===t||document.mozFullScreenElement===t)t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock();e.layer.game.resetSize()},pointerLockChange:function(){var e=this,t=e.layer.game.canvas;document.mozPointerLockElement===t||document.webkitPointerLockElement===t?e.layer.unPauseGame&&(e.layer.unPauseGame(),e.layer.game.focused=!0):e.layer.pauseGame&&(e.layer.pauseGame(),e.layer.game.focused=!1)},lockMouse:function(){var t=this,n=t.layer.game.canvas;t.locked||document.addEventListener("mousemove",function(e){var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;t.layer.running&&(t.mouse_move={x:n,y:r},t.mouse_position_scr.x+n>0&&t.mouse_position_scr.x+n<t.layer.game.canvas.width&&(t.mouse_position_scr.x+=n),t.mouse_position_scr.y+r>0&&t.mouse_position_scr.y+r<t.layer.game.canvas.height&&(t.mouse_position_scr.y+=r))},!1),t.locked=!0,document.addEventListener("fullscreenchange",e.proxy(t.fullscreenChange,t),!1),document.addEventListener("mozfullscreenchange",e.proxy(t.fullscreenChange,t),!1),document.addEventListener("webkitfullscreenchange",e.proxy(t.fullscreenChange,t),!1),document.addEventListener("pointerlockchange",e.proxy(t.pointerLockChange,t),!1),document.addEventListener("mozpointerlockchange",e.proxy(t.pointerLockChange,t),!1),document.addEventListener("webkitpointerlockchange",e.proxy(t.pointerLockChange,t),!1)},requestFullScreen:function(){var e=this,t=e.layer.game.canvas;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen,t.requestFullscreen()},requestLocks:function(){var e=this,t=e.layer.game.canvas;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()},draw:function(){var e=this;e.layer.graphics_engine.drawCircle({x:e.mouse_position.x,y:e.mouse_position.y,fill_style:"white",radius:5/e.layer.camera.zoom});var t=e.layer.graphics_engine.context;r*=.9,r=parseFloat(r.toFixed(5))}}),n}),define("layers/game_layer/physics_engine",["class"],function(e){var t=e.create();return t.extend({}),t.include({init:function(e){var t=this;t.layer=e,t.inputs_engine=e.inputs_engine,t.camera=e.camera},camera_control:function(){var e=this;e.camera.speedX<0&&(e.camera.speedX+=.05),e.camera.speedX>0&&(e.camera.speedX-=.05),e.camera.speedY<0&&(e.camera.speedY+=.05),e.camera.speedY>0&&(e.camera.speedY-=.05),Math.abs(e.camera.speedX)<.05&&(e.camera.speedX=0),Math.abs(e.camera.speedY)<.05&&(e.camera.speedY=0),e.inputs_engine.keyPressed(37)&&(e.camera.speedX-=.1),e.inputs_engine.keyPressed(39)&&(e.camera.speedX+=.1),e.inputs_engine.keyPressed(38)&&(e.camera.speedY-=.1),e.inputs_engine.keyPressed(40)&&(e.camera.speedY+=.1),e.camera.x+=e.camera.speedX,e.camera.y+=e.camera.speedY},run:function(){var e=this;e.camera_control();for(var t in e.layer.objects)e.layer.objects[t].physics(e.layer)}}),t}),define("layers/game_layer/graphics_engine",["class"],function(e){var t=e.create();return t.extend({}),t.include({init:function(e){var t=this;t.layer=e,t.camera=e.camera,t.context=e.game.context,t.canvas=e.game.canvas,t.images=[],t.notifications=[],t.hints=[]},run:function(){var e=this,t=e.layer.game.canvas;e.context=e.layer.game.context;for(var n in e.layer.objects)e.layer.objects[n].predraw&&e.layer.objects[n].predraw(e);for(var n in e.layer.objects)e.layer.objects[n].draw(e);var r=1,t=e.layer.game.canvas,i=0;for(var n in e.hints){var s=t.width/2,o=20;e.context.font="15px verdana",e.context.fillStyle="white";var u=e.context.measureText(e.hints[n]);e.context.fillText(e.hints[n],s+5-u.width/2,o+i),i+=20}e.hints=[]},addHint:function(e){var t=this;t.hints.push(e)},showMainHint:function(e){var t=this,n=t.layer.game.canvas,r=t.context;r.font="40px verdana",r.fillStyle="rgba(150, 0, 0, 1)";var i=r.measureText(e);r.fillText(e,n.width/2-i.width/2,n.height/4*3)},drawCircle:function(e){var t=this,n=t.context,r=t.camera.zoom;e.fill_style?n.fillStyle=e.fill_style:n.fillStyle="gray",e.line_width?n.lineWidth=e.line_width:n.lineWidth=1,e.stroke_style!==undefined?n.strokeStyle=e.stroke_style:n.strokeStyle="#FFFFFF",e.line_width&&(n.beginPath(),n.arc(e.x*r-t.layer.camera.x*r,e.y*r-t.layer.camera.y*r,e.radius*r,0,2*Math.PI,!1),n.stroke(),n.closePath()),e.fill_style&&(n.beginPath(),n.arc(e.x*r-t.layer.camera.x*r,e.y*r-t.layer.camera.y*r,e.radius*r,0,2*Math.PI,!1),n.fill(),n.closePath());if(e.angle!==undefined){n.beginPath(),n.moveTo((e.x-t.layer.camera.x)*r,(e.y-t.layer.camera.y)*r);var i=Math.cos(e.angle)*e.radius,s=Math.sin(e.angle)*e.radius;n.lineTo((e.x-t.layer.camera.x+i)*r,(e.y-t.layer.camera.y+s)*r),n.strokeStyle="black",n.lineWidth=3,n.stroke()}},beginPath:function(){var e=this;e.context.beginPath()},moveTo:function(e){var t=this,n=t.context;n.moveTo((e.x-t.camera.x)*t.camera.zoom,(e.y-t.camera.y)*t.camera.zoom)},lineTo:function(e,t,n){var r=this,i=r.context;i.lineWidth=n!==undefined?n:3,i.strokeStyle=t!==undefined?t:"green",i.lineTo((e.x-r.camera.x)*r.camera.zoom,(e.y-r.camera.y)*r.camera.zoom),i.stroke()},radarTo:function(e,t,n,r,i){var s=this,o=s.context,u=Math.atan2(e.x-t.x,t.y-e.y)+Math.PI/2;for(var a=0;a<10;a++)o.beginPath(),o.lineWidth=r!==undefined?r:4,o.strokeStyle=n!==undefined?n:"white",o.arc((e.x-s.camera.x)*s.camera.zoom,(e.y-s.camera.y)*s.camera.zoom,5*a,u-i/2,u+i/2),o.stroke()},arcTo:function(e,t,n,r){var i=this,s=i.context;s.lineWidth=r!==undefined?r:3,s.strokeStyle=n!==undefined?n:"green",s.arcTo(e.x,e.y,t.x,t.y,2),s.stroke()},drawImage:function(e,t,n,r,i,s,o,u,a){var f=this,l=f.context;if(f.images[e]===undefined){var c=new Image;c.src="resources/"+e,f.images[e]=c}else var c=f.images[e];r=r?r:c.width,i=i?i:c.height,s=s?s:0,o=o?o:0,u=u?u:0,a=a?a:0,l.drawImage(c,s,o,u,a,(t-f.camera.x)*f.camera.zoom-r*f.camera.zoom/2,(n-f.camera.y)*f.camera.zoom-i*f.camera.zoom/2,r*f.camera.zoom,i*f.camera.zoom)},drawImageCentered:function(e,t,n,r,i){var s=this,o=s.context;o.save();if(s.images[e]===undefined){var u=new Image;u.src="resources/"+e,s.images[e]=u}else var u=s.images[e];var a=u.width,f=u.height;xx=(t-s.camera.x)*s.camera.zoom-a*s.camera.zoom/2,yy=(n-s.camera.y)*s.camera.zoom-f*s.camera.zoom/2,o.translate(xx,yy),o.rotate(i),o.drawImage(u,-a/2*s.camera.zoom*r,-f/2*s.camera.zoom*r,a*s.camera.zoom*r,f*s.camera.zoom*r),o.restore()},createRadialGradient:function(e,t,n,r,i){var s=this,o=this.context,u=o.createRadialGradient((e-s.camera.x)*s.camera.zoom,(t-s.camera.y)*s.camera.zoom,n*s.camera.zoom,(e-s.camera.x)*s.camera.zoom,(t-s.camera.y)*s.camera.zoom,0);return u.addColorStop(0,"rgba(255, 255, 255, 0)"),u.addColorStop(.5,i),u.addColorStop(1,r),u},closePath:function(){var e=this;e.context.closePath()},drawText:function(e,t,n,r){var i=this.context},notification:function(e,t){var n=this;n.notifications.push({text:e,time:t,creation:(new Date).getTime()})},drawCache:function(){var e=this,t=e.context;t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,e.canvas.width,e.canvas.height)}}),t}),define("layers/layer",["class","./game_layer/inputs_engine","./game_layer/physics_engine","./game_layer/graphics_engine"],function(e,t,n,r){var i=e.create();return i.include({init:function(e){var i=this;i.game=e,i.game=e,i.camera={x:0,y:0,distance:100,speedX:0,speedY:0,zoom:1},i.inputs_engine=t.init(i),i.physics_engine=n.init(i),i.graphics_engine=r.init(i),i.texts=[],i.photos=[],i.buttons=[],e.running&&i.inputs_engine.requestLocks(),i.elements=[],i.initializeLayer(e)},initializeLayer:function(){},inputs:function(){},physics:function(){},draw:function(){},logic:function(){},run:function(e){var t=this;t.drawBackground(),e&&(t.inputs(),t.logic(),t.physics()),t.draw(),t.drawOverlays(),t.layerRun(e)},resetSize:function(e,t){var n=this},layerRun:function(e){},drawBackground:function(){},drawText:function(e,t,n,r,i,s,o,u){var a=this,t=t*a.game.canvas.width,n=n*a.game.canvas.height;o=o?o:"white",u="normal 18px verdana";var f=a.game.context;f.fillStyle=o,f.font=u;if(s){var l=f.measureText(e);t-=l.width/2}f.fillText(e,t+r,n+i)},drawButton:function(e){var t=this,n=t.game.context,r=t.inputs_engine.mouse_position_scr.x,i=t.inputs_engine.mouse_position_scr.y,s=e.x*t.game.canvas.width+e.ofx,o=e.y*t.game.canvas.height+e.ofy,u=e.width,a=e.height;r>s&&r<s+u&&i>o&&i<o+a?(n.fillStyle="gray",t.inputs_engine.buttonPressed(1)&&!e.active&&(e.active=!0),!t.inputs_engine.buttonPressed(1)&&e.active&&(e.active=!1,e.callback&&e.callback())):(n.fillStyle=e.color,e.active=!1),e.active&&(n.fillStyle="#225E79"),n.fillRect(s,o,u,a),t.drawText(e.text,e.x,e.y,e.ofx+u/2,e.ofy+a-9,!0)},drawOverlays:function(){var e=this;e.is_menu&&e.graphics_engine.drawCache();for(var t in e.elements){var n=e.elements[t];n.type==="text"&&e.drawText(n.text,n.x,n.y,n.ofx,n.ofy,n.centered,n.color,n.font),n.type==="button"&&e.drawButton(n)}e.inputs_engine.draw()},addImage:function(e,t,n,r,i){},addText:function(e,t,n,r,i,s,o,u){var a=this;a.elements.push({type:"text",text:e,centered:s,x:t,y:n,ofx:r,ofy:i,font:u,color:o})},inputs:function(){var e=this;e.inputs_engine.run()},addButton:function(e,t,n,r,i,s,o,u,a){var f=this;f.elements.push({type:"button",text:e,width:s,height:o,x:t,y:n,ofx:r,ofy:i,color:u,callback:a})}}),i}),define("layers/game_layer/game_objects/object",["class"],function(e){var t=e.create();return t.extend({x:0,y:0}),t.include({init:function(e,t){var n=this;n.x=t&&t.x?t.x:0,n.y=t&&t.y?t.y:0;for(var r in t)n[r]=t[r];n.speed=t&&t.speed?t.speed:0,n.speedX=t&&t.speedX?t.speedX:0,n.speedY=t&&t.speedY?t.speedY:0,n.accelerationX=t&&t.accelerationX?t.accelerationX:0,n.accelerationY=t&&t.accelerationY?t.accelerationY:0,n.mass=t&&t.mass?t.mass:0,n.angle=t&&t.angle?t.angle:0,n.speed_control=t&&t.speed_control?t.speed_control:0,n.accel_jet=t&&t.accel_jet?t.accel_jet:0,n.radius=t&&t.radius?t.radius:50,n.offsetx=t&&t.offsetx?t.offsetx:50,n.offsety=t&&t.offsety?t.offsety:50,n.layer=e,n.active_planets=[],n.forces=[]},logic:function(){},draw:function(e){},physics:function(e){},getScreenPos:function(){var e=this;return{x:Math.round(e.x-e.layer.camera.x)*e.layer.camera.zoom,y:Math.round(e.y-e.layer.camera.y)*e.layer.camera.zoom}},distanceTo:function(e){var t=this,n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r);return i},gravityTo:function(e){var t=this,n=t.distanceTo(e);if(n>20+e.radius)var r=n/100;else var r=n*n*100;var i=.8*(t.mass+e.mass);return i},unitVectorTo:function(e){var t=this,n=t.x-e.x,r=t.y-e.y,i=n/Math.sqrt(n*n+r*r),s=r/Math.sqrt(n*n+r*r);return{x:i,y:s}},gravityVectorTo:function(e){var t=this,n=t.unitVectorTo(e),r=t.gravityTo(e);return{x:n.x*r,y:n.y*r}},getSpeed:function(){var e=this;return Math.sqrt(e.speedX*e.speedX+e.speedY*e.speedY)},calcSpeed:function(e,t){var n=this;if(!e||!t)e=n.speedX,t=n.speedY;return Math.sqrt(e*e+t*t)},interractWith:function(e,t){var n=this,r=t,i=r.distanceTo(n);if(!e.inputs_engine.keyPressed(32)){var s=r.gravityTo(n),o=r.unitVectorTo(n),u=o.x,a=o.y,f=r.gravityVectorTo(n),l=f.x,c=f.y,h=n.getScreenPos(),p={x:Math.round(h.x+s*u*1e4),y:Math.round(h.y+s*a*1e4)};r.forceLine={origin:h,dest:p},r.unforceLine={origin:$.extend(!0,{},h),dest:$.extend(!0,{},p)};var d={x:-o.y,y:o.x},v=i<r.radius+r.grav_influence;v&&(n.active_planets.push(r),r.radius>=i&&(l=0,c=0),n.accelerationX+=l,n.accelerationY+=c,r.forces.push({x:l,y:c}),r.active=!0)}}}),t}),define("layers/game_layer/vector",["jquery","class"],function(e,t){var n=t.create();return n.extend({add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},substract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},coeff_mult:function(e,t){return{x:e.x*t,y:e.y*t}},normalize:function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return{x:e.x/t,y:e.y/t}},distance:function(e,t){var r=n.substract(t,e);return Math.sqrt(r.x*r.x+r.y*r.y)},lgth:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},calcSpeed:function(e,t){var n=this;return Math.sqrt(e*e+t*t)}}),n}),define("layers/game_layer/game_objects/player",["jquery","class","./object","../vector"],function(e,t,n,r){var i=n.create();return i.extend({states:{FLYING:0,WALKING:1}}),i.include({init:function(t,n){var r=this;e.proxy(r.father.init,r)(t,n),r.x=0,r.y=0,r.radius=10,r.inverse=!1,r.angle_count=0,r.angle_sum=0,r.running=!1,r.current_planet=undefined,r.state=i.states.FLYING,r.angle_correction=!1,r.center={x:undefined,y:undefined},r.temperature=0,r.center_count=0,n!==undefined&&n.x!==undefined&&n.y!==undefined&&(r.x=n.x,r.y=n.y),r.just_inversed=!1,r.mouse_attracted=!1,r.mouse_position={x:0,y:0},r.has_to_fill=!0,r.orbs_count=r.layer.game.debugging?1e3:100,r.water_orbs=r.layer.game.debugging?10:0,r.acid_orbs=r.layer.game.debugging?10:0,r.earth_orbs=r.layer.game.debugging?10:0,r.shield_orbs=r.layer.game.debugging?10:0,r.moved=!0,r.orbs=[],r.orbs_consumption=0,r.score=0,r.previous_closest=0,r.show_radar=!0,r.radar_key=!1,r.last_pos=[],r.cur_frame=0,r.positionned=!1},addAngle:function(e,t){var n=this;t*=t*t,n.angle_sum+=e*t,n.angle_count+=t},addCenter:function(e,t){var n=this;n.center.x==undefined&&(n.center.x=0,n.center.y=0),n.center.x+=e.x,n.center.y+=e.y,n.center_count+=1},logic:function(e){var t=this;t.positionned||(t.x=t.layer.level.sun.x+15e3,t.y=t.layer.level.sun.y,t.speedY=400,t.positionned=!0),t.inputs=e.inputs_engine,t.accelOffsetX=0,t.accelOffsetY=0,t.inputs.keyPressed(87)&&t.closest_distance&&t.closest_distance<2e3?(t.running=!0,t.accel_jet=.5):t.inputs.keyPressed(83)&&t.closest_distance&&t.closest_distance<2e3?(t.running=!0,t.accel_jet=-0.5):(t.running=!1,t.accel_jet=0),t.inputs.keyPressed(69)&&(t.angle+=.2),t.inputs.keyPressed(81)&&(t.angle-=.2),t.inputs.keyPressed(49)?(t.just_inversed||(t.inverse=!t.inverse),t.just_inversed=!0):t.just_inversed=!1,t.layer.running&&t.inputs.buttonPressed(1)?(t.mouse_attracted=!0,t.mouse_position=t.inputs.mouse_position,t.moved||(t.acid_orbs=0,t.water_orbs=0,t.earth_orbs=0),t.moved=!0):(t.mouse_attracted=!1,t.moved||t.layer.graphics_engine.showMainHint("[Left click] Hold to run the engine")),t.closest_distance=-1,t.layer.inputs_engine.keyPressed(82)?t.radar_key||(t.radar_key=!0,t.show_radar=!t.show_radar):t.radar_key=!1,t.state=[],t.target_lifes=[];for(var n in t.layer.level.life_planets){var r=t.layer.level.life_planets[n];r.water_counts<10&&r.acid_counts<10&&r.earth_counts<10&&t.target_lifes.push(r)}t.orbs_count<200&&t.has_to_fill||t.orbs_count<40?(t.state.push("energy_search"),t.orbs_count<40&&(t.has_to_fill=!0)):(t.water_orbs<10||t.acid_orbs<10||t.earth_orbs<10)&&t.target_lifes.length>0?(t.state.push("materials_search"),t.water_orbs<10&&t.state.push("water_search"),t.acid_orbs<10&&t.state.push("acid_search"),t.earth_orbs<10&&t.state.push("earth_search")):t.target_lifes.length>0?t.state.push("life_search"):t.state.push("sun_warmup")},draw:function(e){var t=this,n=t.last_pos.length;for(var i in t.last_pos){var s=n--*t.speed/3e4,o=(30-n)/t.layer.camera.zoom*Math.sqrt(t.speed)/75*t.layer.camera.zoom*100;o=o>0?o:0,e.drawCircle({y:t.last_pos[i].y,x:t.last_pos[i].x,radius:o,fill_style:"rgba(255,100,70,"+s+")",stroke_style:"#FFAA88"})}var u=-t.x+t.inputs.mouse_position.x,a=-t.y+t.inputs.mouse_position.y;t.speed_vector=r.normalize({x:u,y:a}),t.ac_angle=t.ac_angle||0;if(t.inputs.buttonPressed(1)){var f=Math.atan(u/a);a>0&&(f+=Math.PI),f=-f,t.ac_angle=f}else t.ac_angle=t.angle+Math.PI/2;if(t.inputs.buttonPressed(1)||t.inputs.keyPressed(16)){var l=10;for(var n=0;n<10;n++){var s=l/40,o=l/2*100,c="rgba(255,255,255,"+s+")",h="#FFAA88";if(t.inputs.keyPressed(16)){t.inputs.buttonPressed(1)||(t.speed_vector=r.normalize({x:t.speedX,y:t.speedY}));var c="rgba(100,100,255,"+s*2+")"}e.drawCircle({x:t.x-(t.speed_vector.x*5*n/t.layer.camera.zoom+t.speed_vector.x*10/t.layer.camera.zoom),y:t.y-(t.speed_vector.y*5*n/t.layer.camera.zoom+t.speed_vector.y*10/t.layer.camera.zoom),radius:o,fill_style:c,stroke_style:h}),l--}}e.drawImageCentered("ship.png",t.x,t.y,75,t.ac_angle),t.layer.game.debugging&&(e.beginPath(),e.moveTo({x:t.x,y:t.y}),e.lineTo({x:t.x+t.accelerationX*1e3,y:t.y+t.accelerationY*1e3},"blue",2),e.closePath(),e.beginPath(),e.moveTo({x:t.x,y:t.y}),e.lineTo({x:t.x+t.speedX*20,y:t.y+t.speedY*20},"green",2),e.closePath());var p=t.layer.game.context;for(var i in t.active_planets)e.beginPath(),e.moveTo({x:t.x,y:t.y}),e.lineTo({x:t.active_planets[i].x,y:t.active_planets[i].y},"blue",1);e.beginPath(),e.moveTo({x:t.x,y:t.y});var d=r.normalize({x:t.layer.level.sun.x-t.x,y:t.layer.level.sun.y-t.y});if(t.show_radar){radars={targets:[],energy:{distance:-1,target:undefined},water:{distance:-1,target:undefined},earth:{distance:-1,target:undefined},acid:{distance:-1,target:undefined}};for(var i in t.layer.level.planets){var v=t.layer.level.planets[i],m=t.distanceTo({x:v.x,y:v.y}),h="black";switch(v.planet_type){case"water":(m<radars.water.distance||radars.water.distance<0)&&v.orbs.length>0&&t.state.indexOf("water_search")!==-1&&(h="rgba(0,0,255,"+5e5/m+")",radars.water.distance=m,radars.water.target={x:v.x,y:v.y,color:h});break;case"energy":(m<radars.energy.distance||radars.energy.distance<0)&&v.orbs.length>0&&t.state.indexOf("energy_search")!==-1&&(radars.energy.distance=m,h="rgba(255,150,0,"+1e5/m+")",radars.energy.target={x:v.x,y:v.y,color:h});break;case"acid":(m<radars.acid.distance||radars.acid.distance<0)&&v.orbs.length>0&&t.state.indexOf("acid_search")!==-1&&(radars.acid.distance=m,h="rgba(0,255,0,"+5e4/m+")",radars.acid.target={x:v.x,y:v.y,color:h});break;case"earth":(m<radars.earth.distance||radars.earth.distance<0)&&v.orbs.length>0&&t.state.indexOf("earth_search")!==-1&&(radars.earth.distance=m,h="rgba(255,0,0,"+5e4/m+")",radars.earth.target={x:v.x,y:v.y,color:h});break;case"life":t.state.indexOf("life_search")!==-1&&v.water_counts<10&&v.earth_counts<10&&v.acid_counts<10&&(h="rgba(255,255,255,"+5e5/m+")",radars.targets.push({x:v.x,y:v.y,color:h}));break;case"sun":h="rgba(255,255,0,"+5e4/m+")",t.state.indexOf("sun_warmup")!==-1&&radars.targets.push({x:v.x,y:v.y,color:h});break;default:}}radars.energy.target&&radars.targets.push(radars.energy.target),radars.acid.target&&radars.targets.push(radars.acid.target),radars.water.target&&radars.targets.push(radars.water.target),radars.earth.target&&radars.targets.push(radars.earth.target);for(var i in radars.targets){var v=radars.targets[i];e.beginPath();var d=r.normalize({x:v.x-t.x,y:v.y-t.y});e.moveTo({x:t.x,y:t.y}),e.radarTo({x:t.x,y:t.y},{x:t.x+d.x*50/t.layer.camera.zoom,y:t.y+d.y*50/t.layer.camera.zoom},v.color,2,Math.PI/10)}t.mouse_attracted&&(e.beginPath(),e.moveTo({x:t.x,y:t.y}),e.lineTo({x:t.layer.inputs_engine.mouse_position.x,y:t.layer.inputs_engine.mouse_position.y},"rgba(255, 0, 0, 0.3)",3)),t.layer.graphics_engine.addHint("[R] Hide Radar")}else t.layer.graphics_engine.addHint("[R] Show Radar");t.forces=[],t.accelerationX=0,t.accelerationY=0},physics:function(e){var t=this;t.active_planets=[],t.last_pos.length>30&&t.last_pos.shift(),t.last_pos.push({x:t.x,y:t.y});var n=!1;for(var i in e.planets){e.planets[i].closest=!1,e.planets[i].close=!1;var s=t.distanceTo(e.planets[i])-e.planets[i].radius;if(s<t.closest_distance||t.closest_distance==-1)t.closest_distance=s,t.closest_planet=e.planets[i];var o=e.planets[i];s<o.grav_influence+o.radius,s<=o.influence+o.radius&&s>=10+o.radius?(t.temperature<20||t.temperature>24?t.temperature+=t.temperature<22?2:-2:t.temperature=20,n=!0):s<10+o.radius&&t.temperature<500&&(t.temperature+=1),n?t.color="blue":t.temperature>-273&&(t.temperature-=.02)}t.closest_planet.closest=!0,t.closest_planet.close=!0;for(var i in e.planets)t.interractWith(e,e.planets[i]);t.speedX!=0&&(t.angle=Math.atan(t.speedY/t.speedX),t.speedX<0&&(t.angle+=Math.PI),t.speedY<0&&(t.angle+=2*Math.PI));var u={x:0,y:0};t.speed=Math.sqrt(t.speedX*t.speedX+t.speedY*t.speedY);if(t.mouse_attracted&&t.orbs_count>0){var a={x:t.mouse_position.x-t.x,y:t.mouse_position.y-t.y};a=r.normalize(a),a=r.coeff_mult(a,1),t.speed<500?(u.x=a.x*10,u.y=a.y*10,t.orbs_count-=.1):(t.speedX*=.99,t.speedY*=.99),t.orbs_count<0&&(t.orbs_count=0)}t.speedX+=t.accelerationX+Math.cos(t.angle)*t.accel_jet+u.x,t.speedY+=t.accelerationY+Math.sin(t.angle)*t.accel_jet+u.y,t.speed=Math.sqrt(t.speedX*t.speedX+t.speedY*t.speedY);if(t.closest_planet){var s=t.distanceTo(t.closest_planet);if(s<t.closest_planet.radius){var f=t.closest_planet.unitVectorTo(t);t.x-=(t.closest_planet.radius-s)*f.x,t.y-=(t.closest_planet.radius-s)*f.y,t.speedX-=t.speed*f.x/10,t.speedY-=t.speed*f.y/10}else s<t.closest_planet.radius+5?(t.speedX*=.9,t.speedY*=.9):Math.abs(r.distance(t,t.closest_planet)-t.previous_closest)<10&&t.moved&&(t.score+=t.closest_distance/1e3);t.previous_closest=r.distance(t,t.closest_planet)}var l=1;t.warp_add=t.warp_add||{x:0,y:0},t.inputs.keyPressed(16)&&t.orbs_count>0&&(l=5,t.orbs_count-=.05),t.x+=t.speedX*l+t.offsetx+t.warp_add.x,t.y+=t.speedY*l+t.offsety+t.warp_add.y,t.warp_add.x*=.9,t.warp_add.y*=.9,t.closest_planet&&(t.closest_distance<t.closest_planet.influence&&t.layer.graphics_engine.addHint("[Space] Leave the planet's orbital influence"),t.closest_planet.destination&&(t.layer.graphics_engine.addHint("[Enter] Increase sun rays influence (consumes energy)"),t.layer.inputs_engine.keyPressed(13)&&t.orbs_count>25&&(t.closest_planet.addOrb(),t.closest_planet.addOrb(),t.orbs_count-=2,t.score+=5)),t.closest_planet.planet_type=="life"&&(t.layer.graphics_engine.addHint("[Enter] Drop collected materials to help life come to this planet"),t.layer.inputs_engine.keyPressed(13)&&(t.water_orbs>0&&t.closest_planet.water_counts<10&&(t.closest_planet.addOrb("water"),t.water_orbs-=1,t.score+=10,t.closest_planet.water_counts>=10&&(t.score+=100)),t.acid_orbs>0&&t.closest_planet.acid_counts<10&&(t.closest_planet.addOrb("acid"),t.acid_orbs-=1,t.score+=10,t.closest_planet.acid_counts>=10&&(t.score+=100)),t.earth_orbs>0&&t.closest_planet.earth_counts<10&&(t.closest_planet.addOrb("earth"),t.earth_orbs-=1,t.score+=10,t.closest_planet.earth_counts>=10&&(t.score+=100)))));var c=t.closest_planet.orbs;if(t.closest_planet.planet_type!="life"&&(!t.closest_planet.destination||t.layer.inputs_engine.keyPressed(90))){t.closest_planet.planet_type=="energy"&&t.layer.graphics_engine.addHint("Orbit around this planet to increase your ship's ENERGY"),t.closest_planet.planet_type=="water"&&t.layer.graphics_engine.addHint("Orbit around this planet to fill your WATER tanks"),t.closest_planet.planet_type=="acid"&&t.layer.graphics_engine.addHint("Orbit around this planet to fill your AMINATE ACIDS tanks"),t.closest_planet.planet_type=="earth"&&t.layer.graphics_engine.addHint("Orbit around this planet to fill your EARTH tanks");for(var i in c){var h=c[i],p=t.distanceTo(h),d=t.unitVectorTo(h);p<1e4&&(h.type==="water"&&t.water_orbs<10||h.type==="earth"&&t.earth_orbs<10||h.type==="acid"&&t.acid_orbs<10||h.type==="energy")&&(h.offsetx+=p>10?d.x*(t.speed+5):0,h.offsety+=p>10?d.y*(t.speed+5):0),p<900&&(h.type==="energy"&&(t.orbs_count++,t.score+=1,c.splice(i,1),t.orbs_count>=200&&t.has_to_fill&&(t.has_to_fill=!1)),h.type=="water"&&t.water_orbs<10&&(t.water_orbs++,t.closest_planet.water_counts--,t.score+=10,c.splice(i,1)),h.type=="acid"&&t.acid_orbs<10&&(t.acid_orbs++,t.closest_planet.acid_counts--,t.score+=10,c.splice(i,1)),h.type=="earth"&&t.earth_orbs<10&&(t.earth_orbs++,t.closest_planet.earth_counts--,t.score+=10,c.splice(i,1)),h.type=="shield"&&t.shield_orbs<10&&(t.shield_orbs++,c.splice(i,1)))}}t.offsetx=0,t.offsety=0,t.angle_count=0,t.center={x:0,y:0},t.center_count=0,t.angle_sum=0,t.angle_correction=!1,t.closest_distance=-1,t.planet&&!t.moved&&(t.x=t.planet.x+t.planet.radius+100,t.y=t.planet.y+t.planet.radius+100,t.speedX=0,t.speedY=0,t.accelerationX=0,t.accelerationY=0),t.layer.game.score=Math.round(t.score)}}),i}),define("layers/game_layer/game_objects/energy_orb",["./object"],function(e){var t=e.create();return t.extend({}),t.include({init:function(e,t){var n=this;$.proxy(n.father.init,n)(e,t);var r=n.x-n.center.x,i=n.y-n.center.y;n.layer=e,n.y-n.center.y!=0?n.angle=Math.atan(i/r):n.angle=0,r<0&&(n.angle+=Math.PI),i<0&&(n.angle+=2*Math.PI),n.offsetx=0,n.offsety=0,n.distance_factor=Math.random(),n.distance=n.center.radius+50+n.distance_factor*n.center.grav_influence,n.speed=Math.random()*.005+.001,n.type=t.type?t.type:"energy",n.radius=10},physics:function(){var e=this;e.center&&e.center.close&&(e.x=e.center.x+Math.cos(e.angle)*(20*(Math.cos(e.angle*e.distance/20)+1)+e.distance)+e.offsetx,e.y=e.center.y+Math.sin(e.angle)*(20*(Math.cos(e.angle*e.distance/20)+1)+e.distance)+e.offsety,e.angle+=e.speed),e.distance=e.center.radius+50+e.distance_factor*e.center.grav_influence},draw:function(e){var t=this;if(t.center&&t.center.close){t.radius=3/e.layer.camera.zoom;var n=e.createRadialGradient(t.x,t.y,t.radius,"rgba(100,100,255,0.5)","white");switch(t.type){case"water":n=e.createRadialGradient(t.x,t.y,t.radius,"rgba(100,100,255,0.5)","blue");break;case"acid":n=e.createRadialGradient(t.x,t.y,t.radius,"rgba(100,100,255,0.5)","green");break;case"shield":n=e.createRadialGradient(t.x,t.y,t.radius,"rgba(100,100,255,0.5)","violet");break;case"earth":n=e.createRadialGradient(t.x,t.y,t.radius,"rgba(255,150,100,0.5)","violet");break;default:}e.layer.camera.zoom>.001&&(e.beginPath(),e.drawCircle({x:t.x,y:t.y,radius:t.radius,fill_style:n}),e.closePath())}}}),t}),define("layers/game_layer/game_objects/planet",["./object","./player","./energy_orb","../vector"],function(e,t,n,r){var i=e.create();return i.extend({}),i.include({type:"planet",addOrb:function(e,t){var r=this;e=e?e:"energy",t=t!==undefined?t:0;var i=n.init(r.layer,{x:r.x+Math.cos(Math.random()*2*Math.PI)*(r.radius+50+Math.random()*300),y:r.y+Math.sin(Math.random()*2*Math.PI)*(r.radius+50+Math.random()*300),radius:20,center:r,type:e});switch(e){case"water":r.water_counts++;break;case"acid":r.acid_counts++;break;case"earth":r.earth_counts++;break;default:}r.orbs.push(i)},init:function(e,t){var n=this;n.temperature=0,n.layer=e,$.proxy(n.father.init,n)(),n.extend(t),n.radius=t.radius,n.mass=10,n.water_counts=0,n.acid_counts=0,n.earth_counts=0,n.planet_type=t.planet_type?t.planet_type:"energy",n.influence=t.influence||300,n.speed=50*(t.speed_factor?t.speed_factor:1),n.destination=t.destination?t.destination:!1,n.orbs=[],n.origin_orbs=0,n.grav_influence=n.destination?2e4:15e3,n.alive=!1,n.active=!1,n.previous_active=!1;var r="energy";switch(n.planet_type){case"water":n.origin_orbs=20+10*Math.random(),r="water";break;case"energy":n.origin_orbs=50,r="energy";break;case"acid":n.origin_orbs=20+10*Math.random(),r="acid";break;case"shield":n.origin_orbs=20+10*Math.random(),r="shield";break;case"earth":n.origin_orbs=20+10*Math.random(),r="earth";break;case"life":n.origin_orbs=0,r="none";break;case"sun":n.origin_orbs=200,r="energy";break;default:n.origin_orbs=50,r="energy"}for(var i=0;i<n.origin_orbs;i++)n.addOrb(r,i);n.center&&n.center.x&&n.center.y&&(n.x=n.center.x+Math.cos(i/25*Math.PI)*n.orbit_distance,n.y=n.center.y+Math.sin(i/25*Math.PI)*n.orbit_distance),n.angle=t.angle?t.angle:Math.random()*Math.PI*2,n.image_disx=0,n.image_ddx=1,n.image_disy=0,n.image_factor=0,n.previous_alive=!1,n.warmup=0},setVector:function(e,t){var n=this;n.x=e,n.y=t},setRadius:function(e){var t=this;t.radius=e},physics:function(e){var t=this;t.layer=e,e.game.debugging&&e.inputs_engine.keyPressed(77)&&(t.water_counts=10,t.earth_counts=10,t.acid_counts=10),t.planet_type=="sun"?t.temperature=t.orbs.length>t.radius/2?1e3:t.orbs.length/(t.radius/2)*1e3:t.planet_type=="life"?t.temperature=t.water_counts/10:t.temperature=t.origin_orbs>0?t.orbs.length/t.origin_orbs*1e3:0,t.destination?t.influence=t.orbs.length*2e3:t.planet_type=="life"?t.influence=(t.water_counts/10+t.acid_counts/10+t.earth_counts/10)/3*500:t.influence=t.origin_orbs>0?t.orbs.length/t.origin_orbs*1e4:0,t.center!==undefined&&(t.center.x&&t.center.y&&(t.x=t.center.x+Math.cos(t.angle)*t.orbit_distance,t.y=t.center.y+Math.sin(t.angle)*t.orbit_distance),t.angle+=t.speed/t.orbit_distance);for(var n in t.orbs)t.orbs[n].physics();t.planet_type=="life"&&t.center&&r.distance(t.center,t)<t.center.influence&&t.water_counts>=10&&t.earth_counts>=10&&t.acid_counts>=10&&(t.warmup<=500&&r.distance(t.center,t)<t.center.influence?t.warmup+=1:(t.alive=!1,r.distance(t.center,t)>t.center.influence&&(t.warmup-=1)),t.warmup>=500&&r.distance(t.center,t)<t.center.influence?(t.alive=!0,t.warming=!1):t.warming=!0,t.previous_alive||(e.player.score+=1e3)),t.previous_alive=t.alive},predraw:function(e){var t=this,n=t.x,r=t.y,i=t.radius,s=e.createRadialGradient(t.x,t.y,i+t.influence,"rgba(255,255,255,0.5)","rgba(255,255,0,0.1)");switch(t.planet_type){case"energy":s=e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgba(255,255,100,0.5)"),t.color="rgb( "+255*t.temperature/1e3+",  "+255*t.temperature/1e3+", "+255*t.temperature/1e3+")";break;case"water":s=e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgba(0,0,255,0.5)"),t.color="rgb(0, 0, "+255*t.temperature/1e3+")";break;case"acid":s=e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgba(0,255,0,0.5)"),t.color="rgb(0, "+255*t.temperature/1e3+", 0)";break;case"shield":s=e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgba(255,0,255,0.5)"),t.color="rgb(0, "+255*t.temperature/1e3+", "+255*t.temperature/1e3+")";break;case"earth":s=e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgba(255,0,255,0.5)"),t.color="rgb(0, "+255*t.temperature/1e3+", "+255*t.temperature/1e3+")";break;case"life":s=t.alive?e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgb(100, 255, 255)"):e.createRadialGradient(t.x,t.y,i+t.influence,"white","rgb(255, 255, 255)"),t.color=t.alive?"white":"rgb("+(100*t.earth_counts/10+50)+", "+(100*t.acid_counts/10+50)+", "+(100*t.water_counts/10+50)+")";break;default:}e.drawCircle({x:n,y:r,radius:i+t.influence,fill_style:s}),e.drawCircle({x:n,y:r,radius:i+t.grav_influence,line_width:1}),t.destination||e.drawCircle({x:n,y:r,radius:i,line_width:1})},draw:function(e){var t=this,n=t.x,r=t.y,i=t.radius;t.color="rgb(0, 0, 0)",t.destination&&(t.color="rgb("+Math.round(255*(t.temperature/1e3))+", "+Math.round(255*(t.temperature/1e3))+", "+Math.round(255*(t.temperature/1e3))+")"),t.destination||e.drawCircle({x:n,y:r,radius:i,fill_style:t.color});if(t.planet_type!="life"||!t.alive)for(var s in t.orbs)t.orbs[s].draw(e);t.planet_type=="life"&&t.alive&&e.drawCircle({x:n,y:r,radius:i*30,fill_style:"rgba(255,255,255,0.3)"});if(t.destination){var o=t.influence>0?t.influence/2e4:.01;t.radius=500*o,e.drawCircle({x:n,y:r,radius:t.radius,fill_style:"rgba(255,255,255,0.9)"})}t.previous_active=t.active,t.active=!1}}),i}),define("layers/game_layer/level_generator",["./game_objects/planet","./game_objects/player"],function(e,t){var n=function(r,i){var s=[],o=[],u,a=e.init(r,{x:r.game.canvas.width/2/r.camera.zoom,y:r.game.canvas.height/2/r.camera.zoom,radius:1e3,destination:!0,planet_type:"sun"});s.push(a);if(i!==undefined&&i.planets!==undefined){var f=0,l=0,c=0,h=0,p=0,d=[];for(var v=0;v<100;v++){var m=Math.round(Math.random()*10),g="";p<25?Math.random()*(5-p)<.7&&(g="earth",p++):c<3?Math.random()*(3-c)<.7&&(g="life",c++):h<25?Math.random()*(5-h)<.7&&(g="acid",h++):f<25&&Math.random()*(5-f)<.7&&(g="water",f++);if(g!=="")switch(m){case 0,1:g="water",f++;break;case 2,3:g="acid",h++;break;case 4,5:g="earth",p++;break;case 3:break;default:l++}var y=500+200*Math.random(),b=.5+Math.random()*1.5,w=e.init(r,{center:a,orbit_distance:v*(2*y+16e3)+(a.radius+4e4),speed_factor:b,radius:y,planet_type:g,angle:0});s.push(w),w.planet_type=="life"&&d.push(w)}s.push(w)}return u=t.init(r,{planet:a}),{planets:s,objects:o,player:u,generate:n,life_planets:d,sun:a}};return{generate:n}}),define("layers/menu_layer",["class","./layer"],function(e,t){var n=t.create();return n.include({initializeLayer:function(){var e=this;e.is_menu=!0,e.menu_init()},menu_init:function(){},pauseGame:function(){var e=this;e.running=!1},unPauseGame:function(){var e=this;e.running=!0}}),n}),define("layers/menu_layers/pause_menu",["class","../menu_layer"],function(e,t){var n=t.create();return n.include({menu_init:function(){var e=this;e.addText("Pause menu",.5,.5,0,-100,!0),e.addText("Current score : "+e.game.score,.5,.5,0,100,!0),e.addButton("Resume",.5,.5,-75,-83,150,30,"#BF3030",function(){e.game.popLayer()}),e.addButton("Main menu",.5,.5,-75,-50,150,30,"#BF3030",function(){e.game.startMenu()}),e.addButton("Toggle music",.5,.5,-75,33,150,30,"#BF3030",function(){e.game.music_playing?e.game.stopMusic():e.game.startMusic()}),e.addButton("Vol-",.5,.5,-75,66,74,30,"#BF3030",function(){e.game.volumeDown()}),e.addButton("Vol+",.5,.5,0,66,74,30,"#BF3030",function(){e.game.volumeUp()})}}),n}),define("layers/hud",["./layer","./game_layer/vector"],function(e,t){var n=e.create();return n.include({initializeLayer:function(){var e=this},setup:function(e){var t=this;t.layer=e;var n={};n.eorb=new Image,n.eorb.src="resources/orb_energy.png",n.worb=new Image,n.worb.src="resources/orb_water.png",n.torb=new Image,n.torb.src="resources/orb_earth.png",n.aorb=new Image,n.aorb.src="resources/orb_acid.png",n.norb=new Image,n.norb.src="resources/orb_absent.png",n.battery=new Image,n.battery.src="resources/battery.png",n.lightning=new Image,n.lightning.src="resources/lightning.png",t.images=n,t.show_hints=!1},drawPlayerInformation:function(){var e=this,t=e.layer.game.canvas,n=5,r=5,i=110,s=250,o=e.layer.game.context,u=e.layer.player;o.fillStyle="rgba(255,255,255,0.2);",o.strokeStyle="rgba(255,255,255,0.5);",o.lineWidth=2,o.beginPath(),o.rect(r,n,s,i),o.fill(),o.stroke(),o.font="15px verdana",o.fillStyle="white";for(var a=0;a<u.water_orbs;a++)o.drawImage(e.images.worb,r+5+a*20,n+3);while(a<10)o.drawImage(e.images.norb,r+5+a*20,n+3),a++;for(var a=0;a<u.acid_orbs;a++)o.drawImage(e.images.aorb,r+5+a*20,n+23);while(a<10)o.drawImage(e.images.norb,r+5+a*20,n+23),a++;for(var a=0;a<u.earth_orbs;a++)o.drawImage(e.images.torb,r+5+a*20,n+43);while(a<10)o.drawImage(e.images.norb,r+5+a*20,n+43),a++;o.drawImage(e.images.battery,r+5,n+75),o.fillText(u.orbs_count.toFixed(2),r+40,n+98);if(u.speed){o.save(),o.translate(5,150),o.fillText("Primary engine speed capacity",0,0),o.fillStyle="gray",o.fillRect(0,10,250,10);if(u.speed>500)o.fillStyle="#FF0000";else{var f=Math.floor(u.speed/500*255),l=Math.floor(255-u.speed/500*255);o.fillStyle="rgba("+f+", "+l+", 0, 1)"}o.fillRect(0,10,u.speed/500*250,10),u.speed>=490&&!e.layer.inputs_engine.keyPressed(16)&&(o.font="16px verdana",o.fillStyle="white",o.fillText("Use SHIFT to use WARP ENGINE",0,40)),e.layer.inputs_engine.keyPressed(16)&&(o.font="16px verdana",o.fillStyle="white",o.fillText("Warp engine ACTIVE : speed x 5",0,40)),o.restore()}},drawPlanetInformation:function(){var e=this,n=e.layer.game.canvas,r=n.height-110,i=5,s=115,o=250,u=e.layer.game.context,a=e.layer.player;u.fillStyle="rgba(255,255,255,0.2);",u.strokeStyle="rgba(255,255,255,0.5);",u.lineWidth=2,u.beginPath(),u.rect(i,r-10,o,s),u.fill(),u.stroke(),u.font="15px verdana",u.fillStyle="white";if(a.closest_planet&&t.distance(a.closest_planet,a)<=a.closest_planet.radius+a.closest_planet.grav_influence){var f=a.closest_planet;u.fillText("Planet type : "+a.closest_planet.planet_type,10,r+10),u.fillText("Distance : "+t.distance(a.closest_planet,a).toFixed(2),10,r+30),a.closest_planet.destination&&u.fillText("[Enter] : drop energy orbs",10,r+50);var l=r+35;a.closest_planet.planet_type=="energy"&&(u.drawImage(e.images.eorb,10,l),u.fillText(f.orbs.length+" left",40,l+15)),a.closest_planet.planet_type=="earth"&&(u.drawImage(e.images.torb,10,l),u.fillText(f.orbs.length+" left",40,l+15)),a.closest_planet.planet_type=="water"&&(u.drawImage(e.images.worb,10,l),u.fillText(f.orbs.length+" left",40,l+15)),a.closest_planet.planet_type=="acid"&&(u.drawImage(e.images.aorb,10,l),u.fillText(f.orbs.length+" left",40,l+15)),f.planet_type=="life"&&(u.drawImage(e.images.worb,10,l),u.fillText(f.water_counts+"/10",35,l+15),u.drawImage(e.images.torb,85,l),u.fillText(f.earth_counts+"/10",105,l+15),u.drawImage(e.images.aorb,155,l),u.fillText(f.acid_counts+"/10",175,l+15),u.drawImage(e.images.lightning,10,l+23),f.distanceTo(f.center)<f.center.influence?u.fillText("Touched by sunrays",35,l+40):u.fillText("Untouched by sunrays",35,l+40),f.warming&&u.fillText("Planet currently warming "+Math.round(f.warmup/500*100)+"%",10,l+55),(f.acid_counts<10||f.earth_counts<10||f.water_orbs<10)&&u.fillText("[Enter] : drop orbs",10,l+60))}else u.fillText("No near planet",10,r+10)},drawObjectives:function(){var e=this,t=e.layer.game.canvas,n=110,r=250,i=t.width-5-r,s=t.height-5-n,o=e.layer.game.context,u=e.layer.player;o.fillStyle="rgba(255,255,255,0.2);",o.strokeStyle="rgba(255,255,255,0.5);",o.lineWidth=2,o.beginPath(),o.rect(i,s,r,n),o.fill(),o.stroke(),o.font="15px verdana",o.fillStyle="white",o.fillText("Objectives",i+5,s+20),o.fillText(e.layer.alive_planets+"/"+e.layer.life_planets+" planets to revive",i+5,s+40),e.layer.warming_planets>0&&o.fillText(e.layer.warming_planets+" planets planets warming",i+5,s+60),o.fillText(e.layer.warmup_percentage+"% of success",i+5,s+80)},drawHints:function(){var e=this,t=e.layer.game.canvas,n=e.layer.game.context,r=e.layer.player;n.font="15px verdana",n.fillStyle="white";var i=["To win this game :","First: gather materials and energy orbs by orbiting around other planets","Second: drop materials to life planets (indicated by your radars in GREEN)","Third: make the sun rays reach those planets to revive them by dropping energy orbs on the sun (radar: yellow)","","[Scroll] Zoom In/Out","[Left click] Hold to run engine and accelerate towards the pointer (costs energy)","[P] Pause menu","[Escape] Pause and unlock mouse"],s=t.width/2,o=t.height-i.length*20;if(e.show_hints){n.font="15px verdana",n.fillStyle="white";var u=0,a=0;for(var f in i){n.font="15px verdana",n.fillStyle="white";var l=n.measureText(i[f]);u<l.width&&(u=l.width),n.fillText(i[f],s+5-l.width/2,o+a),a+=20}n.fillStyle="rgba(255,255,255,0.2);",n.strokeStyle="rgba(255,255,255,0.5);",n.lineWidth=2,n.beginPath(),n.rect(t.width/2-(u+10)/2,o-20,u+10,i.length*20+10),n.fill(),n.stroke()}else{var c="[H] Show commands help",l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-20)}for(var f in r.state){var h=r.state[f],c="";switch(h){case"energy_search":n.font="25px verdana",n.fillStyle="yellow",c+="Get energy : "+Math.floor(r.orbs_count)+" / 200";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-200);break;case"materials_search":n.font="25px verdana",n.fillStyle="yellow",c+="Fill your tanks :";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-200),c="",n.font="20px verdana";var a=175;if(r.state.indexOf("earth_search")!==-1){n.fillStyle="red";var c="";c+="Earth (red planets, red radar)";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-a),a-=25}if(r.state.indexOf("water_search")!==-1){n.fillStyle="blue",c="",c+="Water (blue planets, blue radar)";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-a),a-=25}if(r.state.indexOf("acid_search")!==-1){c="",n.fillStyle="green",c+="Aminate Acids (green planets, green radar)";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-a)}break;case"life_search":n.font="25px verdana",n.fillStyle="yellow",c+="Drop materials on life planets (white radar).";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-200),n.font="20px verdana",n.fillStyle="white",c="Hold [ENTER] to drop.";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-175);break;case"sun_warmup":n.font="25px verdana",n.fillStyle="yellow",c+="Gather energy and drop it on the sun (white radar, ENTER key).";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-200),n.font="20px verdana",n.fillStyle="white",c="Hold [ENTER] to drop.";var l=n.measureText(c);n.fillText(c,s+5-l.width/2,t.height-175);break;default:}}},draw:function(){var e=this;e.drawPlanetInformation(),e.drawPlayerInformation(),e.drawObjectives(),e.drawHints(),e.layer.inputs_engine.keyPressed(72)?e.hpressed||(e.show_hints=!e.show_hints,e.hpressed=!0):e.hpressed=!1}}),n}),define("layers/game_layer",["class","./layer","./game_layer/inputs_engine","./game_layer/physics_engine","./game_layer/graphics_engine","./game_layer/game_objects/planet","./game_layer/game_objects/player","./game_layer/level_generator","./game_layer/vector","./menu_layers/pause_menu","./hud"],function(e,t,n,r,i,s,o,u,a,f,l){var c=t.create();return c.include({initializeLayer:function(e){var t=this;t.game=e,t.camera={x:-500,y:-500,distance:100,speedX:0,speedY:0,zoom:.01},t.inputs_engine=n.init(t),t.physics_engine=r.init(t),t.graphics_engine=i.init(t),t.objects=[],t.planets=[],t.orbs=[],t.mobile_objects=[],t.level=u.generate(t,{planets:10}),t.player=t.level.player,t.objects.push(t.player),t.mobile_objects.push(t.player);for(var s in t.level.planets)t.objects.push(t.level.planets[s]),t.planets.push(t.level.planets[s]);t.running=t.game.focused,t.paused=!1,t.hud_layer=l.init(t.game),t.hud_layer.setup(t),t.alive_planets=0,t.life_planets=0,t.warming_planets=0;for(var s in t.planets)t.planets[s].planet_type=="life"&&t.life_planets++;t.warmup_percentage=0},cameraPos:function(e){var t=this;e.x&&(t.camera.x=e.x),e.y&&(t.camera.y=e.y)},logic:function(){var e=this;e.last&&(e.paused=!1);for(var t in e.objects)e.objects[t].logic(e);var n=!0,r=!1;e.alive_planets=0,e.warmup_percentage=0,e.warming_planets=0;for(var t in e.planets){var i=e.planets[t];!i.alive&&i.planet_type=="life"&&(n=!1),i.planet_type=="life"&&i.alive&&(e.alive_planets++,e.warmup_percentage+=1),i.planet_type=="life"&&i.warming&&(e.warming_planets++,e.warmup_percentage+=i.warmup/500)}e.player.orbs_count<=0&&(r=!0),e.warmup_percentage=Math.round(e.warmup_percentage/e.life_planets*100),n&&(e.finished=!0,e.game.won(Math.round(e.player.score))),r&&(e.finished=!0,e.game.lost("No energy left")),e.game.debugging&&e.inputs_engine.keyPressed(8)&&(e.finished=!0,e.game.won(Math.round(5e4+Math.random()*5e3))),e.inputs_engine.keyPressed(80)&&e.pauseMenu()},inputs:function(){var e=this;e.inputs_engine.run()},pauseMenu:function(){var e=this;if(!e.finished){e.paused=!0,e.game.running=!0;var t=f.init(e.game);e.game.addLayer(t)}},physics:function(){var e=this;if(e.running){e.player.x<e.camera.x+50&&(e.camera.x=e.player.x-50),e.player.y<e.camera.y+50&&(e.camera.y=e.player.y-50),e.player.x>e.camera.x+e.game.canvas.width/e.camera.zoom-50&&(e.camera.x=e.player.x-e.game.canvas.width/e.camera.zoom+50),e.player.y>e.camera.y+e.game.canvas.height/e.camera.zoom-50&&(e.camera.y=e.player.y-e.game.canvas.height/e.camera.zoom+50);if(Math.abs(e.inputs_engine.getScroll())>1e-4){var t=e.camera.zoom+e.inputs_engine.getScroll()*1e-4;t>=7e-4&&(e.camera.zoom=t)}if(!e.planet_centered){var n={x:e.camera.x+e.game.canvas.width/2/e.camera.zoom,y:e.camera.y+e.game.canvas.height/2/e.camera.zoom},r=e.player.unitVectorTo(n),i=e.player.calcSpeed();e.camera.x=e.player.x-e.game.canvas.width/2/e.camera.zoom,e.camera.y=e.player.y-e.game.canvas.height/2/e.camera.zoom}else if(e.player.closest_planet){var s=e.player.closest_planet,r={x:e.camera.x+e.game.canvas.width/2/e.camera.zoom,y:e.camera.y+e.game.canvas.height/2/e.camera.zoom},o=a.distance(s,r);e.camera.speedX*=.95,e.camera.speedY*=.95;var u=s.unitVectorTo(r);o>a.calcSpeed(e.camera.speedX,e.camera.speedY)+100?(a.lgth({x:e.camera.speedX,y:e.camera.speedY})<30*e.player.closest_planet.speed*e.player.closest_planet.orbit_distance&&(e.camera.speedX+=u.x*15,e.camera.speedY+=u.y*15),e.camera.x+=e.camera.speedX,e.camera.y+=e.camera.speedY):(e.camera.x=s.x-e.game.canvas.width/2/e.camera.zoom,e.camera.y=s.y-e.game.canvas.height/2/e.camera.zoom)}e.physics_engine.run();for(var f in e.planets)e.planets[f].physics(e)}},draw:function(){var e=this;for(var t in e.orbs)e.orbs[t].draw(e.graphics_engine);e.hud_layer.draw(),e.inputs_engine.draw(),e.graphics_engine.run()},layerRun:function(e){var t=this;t.last=e,t.running||t.paused||t.pauseMenu()},pauseGame:function(){var e=this;e.running=!1},unPauseGame:function(){var e=this;e.running=!0}}),c}),define("layers/menu_layers/start_menu",["class","../menu_layer"],function(e,t){var n=t.create();return n.include({menu_init:function(){var e=this;e.addText("Gravity game",.5,.5,0,-80,!0),e.addButton("New game",.5,.5,-75,-66,150,30,"#BF3030",function(){e.game.clearLayers(),e.game.newGame()}),e.addButton("Scores",.5,.5,-75,-33,150,30,"#BF3030",function(){e.game.scoresMenu()}),e.addButton("Toggle music",.5,.5,-75,33,150,30,"#BF3030",function(){e.game.music_playing?e.game.stopMusic():e.game.startMusic()}),e.addButton("Vol-",.5,.5,-75,66,74,30,"#BF3030",function(){e.game.volumeDown()}),e.addButton("Vol+",.5,.5,0,66,74,30,"#BF3030",function(){e.game.volumeUp()}),e.bg=new Image,e.bg.src="resources/menu.png",e.bg_width=0,e.bg_height=0,e.offx=0,e.offy=0,$(e.bg).load(function(){e.resetSize()})},drawBackground:function(){var e=this,t=e.game.context;t.drawImage(e.bg,e.offx,e.offy)},resetSize:function(e,t){var n=this,r=$(document);n.offy=r.height()/2-n.bg.height/2,n.offx=r.width()/2-n.bg.width/2}}),n}),function(e,t){var n=[].slice,r={},i=e.amplify={publish:function(e){var t=n.call(arguments,1),i,s,o,u=0,a;if(!r[e])return!0;i=r[e].slice();for(o=i.length;u<o;u++){s=i[u],a=s.callback.apply(s.context,t);if(a===!1)break}return a!==!1},subscribe:function(e,t,n,i){arguments.length===3&&typeof n=="number"&&(i=n,n=t,t=null),arguments.length===2&&(n=t,t=null),i=i||10;var s=0,o=e.split(/\s/),u=o.length,a;for(;s<u;s++){e=o[s],a=!1,r[e]||(r[e]=[]);var f=r[e].length-1,l={callback:n,context:t,priority:i};for(;f>=0;f--)if(r[e][f].priority<=i){r[e].splice(f+1,0,l),a=!0;break}a||r[e].unshift(l)}return n},unsubscribe:function(e,t){if(!!r[e]){var n=r[e].length,i=0;for(;i<n;i++)if(r[e][i].callback===t){r[e].splice(i,1);break}}}}}(this),function(e,t){function n(e,n){r.addType(e,function(s,o,u){var f,l,h,p,v=o,m=(new Date).getTime();if(!s){v={},p=[],h=0;try{s=n.length;while(s=n.key(h++))i.test(s)&&(l=JSON.parse(n.getItem(s)),l.expires&&l.expires<=m?p.push(s):v[s.replace(i,"")]=l.data);while(s=p.pop())n.removeItem(s)}catch(g){}return v}s="__amplify__"+s;if(o===t){f=n.getItem(s),l=f?JSON.parse(f):{expires:-1};if(!(l.expires&&l.expires<=m))return l.data;n.removeItem(s)}else if(o===null)n.removeItem(s);else{l=JSON.stringify({data:o,expires:u.expires?m+u.expires:null});try{n.setItem(s,l)}catch(g){r[e]();try{n.setItem(s,l)}catch(g){throw r.error()}}}return v})}var r=e.store=function(e,t,n,i){var i=r.type;return n&&n.type&&n.type in r.types&&(i=n.type),r.types[i](e,t,n||{})};r.types={},r.type=null,r.addType=function(e,t){r.type||(r.type=e),r.types[e]=t,r[e]=function(t,n,i){return i=i||{},i.type=e,r(t,n,i)}},r.error=function(){return"amplify.store quota exceeded"};var i=/^__amplify__/;for(var s in{localStorage:1,sessionStorage:1})try{window[s].getItem&&n(s,window[s])}catch(o){}if(window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),r.type==="sessionStorage"&&(r.type="globalStorage")}catch(o){}(function(){if(!r.types.localStorage){var e=document.createElement("div"),n="amplify";e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load(n)}catch(i){e.parentNode.removeChild(e);return}r.addType("userData",function(i,s,o){e.load(n);var u,f,l,h,p,v=s,m=(new Date).getTime();if(!i){v={},p=[],h=0;while(u=e.XMLDocument.documentElement.attributes[h++])f=JSON.parse(u.value),f.expires&&f.expires<=m?p.push(u.name):v[u.name]=f.data;while(i=p.pop())e.removeAttribute(i);return e.save(n),v}i=i.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(s===t){u=e.getAttribute(i),f=u?JSON.parse(u):{expires:-1};if(!(f.expires&&f.expires<=m))return f.data;e.removeAttribute(i)}else s===null?e.removeAttribute(i):(l=e.getAttribute(i),f=JSON.stringify({data:s,expires:o.expires?m+o.expires:null}),e.setAttribute(i,f));try{e.save(n)}catch(g){l===null?e.removeAttribute(i):e.setAttribute(i,l),r.userData();try{e.setAttribute(i,f),e.save(n)}catch(g){throw l===null?e.removeAttribute(i):e.setAttribute(i,l),r.error()}}return v})}})(),function(){function e(e){return e===t?t:JSON.parse(JSON.stringify(e))}var n={},i={};r.addType("memory",function(r,s,o){return r?s===t?e(n[r]):(i[r]&&(clearTimeout(i[r]),delete i[r]),s===null?(delete n[r],null):(n[r]=s,o.expires&&(i[r]=setTimeout(function(){delete n[r],delete i[r]},o.expires)),s)):e(n)})}()}(this.amplify=this.amplify||{}),function(e,t){function n(e){var t=!1;return setTimeout(function(){t=!0},1),function(){var n=this,r=arguments;t?e.apply(n,r):setTimeout(function(){e.apply(n,r)},1)}}function r(e){return{}.toString.call(e)==="[object Function]"}function i(){}e.request=function(t,s,o){var u=t||{};typeof u=="string"&&(r(s)&&(o=s,s={}),u={resourceId:t,data:s||{},success:o});var f={abort:i},l=e.request.resources[u.resourceId],h=u.success||i,p=u.error||i;u.success=n(function(t,n){n=n||"success",e.publish("request.success",u,t,n),e.publish("request.complete",u,t,n),h(t,n)}),u.error=n(function(t,n){n=n||"error",e.publish("request.error",u,t,n),e.publish("request.complete",u,t,n),p(t,n)});if(!l)throw u.resourceId?"amplify.request: unknown resourceId: "+u.resourceId:"amplify.request: no resourceId provided";if(!!e.publish("request.before",u))return e.request.resources[u.resourceId](u,f),f;u.error(null,"abort")},e.request.types={},e.request.resources={},e.request.define=function(t,n,r){if(typeof n=="string"){if(!(n in e.request.types))throw"amplify.request.define: unknown type: "+n;r.resourceId=t,e.request.resources[t]=e.request.types[n](r)}else e.request.resources[t]=n}}(amplify),function(e,t,n){var r=["status","statusText","responseText","responseXML","readyState"],i=/\{([^\}]+)\}/g;e.request.types.ajax=function(i){return i=t.extend({type:"GET"},i),function(s,o){function u(e,i){t.each(r,function(e,t){try{m[t]=f[t]}catch(n){}}),/OK$/.test(m.statusText)&&(m.statusText="success"),e===n&&(e=null),v&&(i="abort"),/timeout|error|abort/.test(i)?m.error(e,i):m.success(e,i),u=t.noop}var f,l=i.url,h=o.abort,p=t.extend(!0,{},i,{data:s.data}),v=!1,m={readyState:0,setRequestHeader:function(e,t){return f.setRequestHeader(e,t)},getAllResponseHeaders:function(){return f.getAllResponseHeaders()},getResponseHeader:function(e){return f.getResponseHeader(e)},overrideMimeType:function(e){return f.overrideMideType(e)},abort:function(){v=!0;try{f.abort()}catch(e){}u(null,"abort")},success:function(e,t){s.success(e,t)},error:function(e,t){s.error(e,t)}};e.publish("request.ajax.preprocess",i,s,p,m),t.extend(p,{success:function(e,t){u(e,t)},error:function(e,t){u(null,t)},beforeSend:function(t,n){f=t,p=n;var r=i.beforeSend?i.beforeSend.call(this,m,p):!0;return r&&e.publish("request.before.ajax",i,s,p,m)}}),t.ajax(p),o.abort=function(){m.abort(),h.call(this)}}},e.subscribe("request.ajax.preprocess",function(e,n,r){var s=[],o=r.data;typeof o!="string"&&(o=t.extend(!0,{},e.data,o),r.url=r.url.replace(i,function(e,t){if(t in o)return s.push(t),o[t]}),t.each(s,function(e,t){delete o[t]}),r.data=o)}),e.subscribe("request.ajax.preprocess",function(e,n,r){var i=r.data,s=e.dataMap;!!s&&typeof i!="string"&&(t.isFunction(s)?r.data=s(i):(t.each(e.dataMap,function(e,t){e in i&&(i[t]=i[e],delete i[e])}),r.data=i))});var s=e.request.cache={_key:function(e,t,n){function r(){return n.charCodeAt(s++)<<24|n.charCodeAt(s++)<<16|n.charCodeAt(s++)<<8|n.charCodeAt(s++)<<0}n=t+n;var i=n.length,s=0,o=r();while(s<i)o^=r();return"request-"+e+"-"+o},_default:function(){var e={};return function(t,n,r,i){var o=s._key(n.resourceId,r.url,r.data),u=t.cache;if(o in e)return i.success(e[o]),!1;var l=i.success;i.success=function(t){e[o]=t,typeof u=="number"&&setTimeout(function(){delete e[o]},u),l.apply(this,arguments)}}}()};e.store&&(t.each(e.store.types,function(t){s[t]=function(n,r,i,o){var u=s._key(r.resourceId,i.url,i.data),l=e.store[t](u);if(l)return i.success(l),!1;var c=o.success;o.success=function(r){e.store[t](u,r,{expires:n.cache.expires}),c.apply(this,arguments)}}}),s.persist=s[e.store.type]),e.subscribe("request.before.ajax",function(e){var t=e.cache;if(t)return t=t.type||t,s[t in s?t:"_default"].apply(this,arguments)}),e.request.decoders={jsend:function(e,t,n,r,i){e.status==="success"?r(e.data):e.status==="fail"?i(e.data,"fail"):e.status==="error"&&(delete e.status,i(e,"error"))}},e.subscribe("request.before.ajax",function(n,r,i,s){function o(e,t){l(e,t)}function u(e,t){f(e,t)}var f=s.success,l=s.error,c=t.isFunction(n.decoder)?n.decoder:n.decoder in e.request.decoders?e.request.decoders[n.decoder]:e.request.decoders._default;!c||(s.success=function(e,t){c(e,t,s,u,o)},s.error=function(e,t){c(e,t,s,u,o)})})}(amplify,jQuery),define("amplify",function(){}),define("layers/menu_layers/end_menu",["class","../menu_layer","amplify"],function(e,t){function r(e,t){return-e.score+t.score}var n=t.create();return n.include({menu_init:function(){var e=this;if(e.game.score>0){e.addText("You won",.5,.5,0,-70,!0),e.addText("Your score : "+e.game.score+" points",.5,.5,0,-30,!0),e.addButton("New game",.5,.5,-75,0,150,30,"#BF3030",function(){e.game.clearLayers(),e.game.newGame()}),e.addButton("Main menu",.5,.5,-75,33,150,30,"#BF3030",function(){e.game.startMenu()});var t=amplify.store("gravitygame_scores");t||(t=[]);var n={score:e.game.score,date:new Date};t.push(n),t.sort(r),amplify.store("gravitygame_scores",t)}else e.addText("You lost: "+e.game.lost_reason,.5,.5,0,-70,!0),e.addButton("New game",.5,.5,-75,0,150,30,"#BF3030",function(){e.game.clearLayers(),e.game.newGame()}),e.addButton("Main menu",.5,.5,-75,33,150,30,"#BF3030",function(){e.game.startMenu()})}}),n}),define("layers/menu_layers/scores_menu",["class","../menu_layer","amplify"],function(e,t){var n=t.create();return n.include({menu_init:function(){var e=this;e.inputs_engine.requestLocks(),e.addText("High Scores",.5,.5,0,-100,!0);var t=amplify.store("gravitygame_scores");if(t)for(var n=0;n<(t.length>10?10:t.length);n++){var r=new Date(t[n].date),i=t[n].score;e.addText((r.getDate()<10?"0":"")+r.getDate()+"/"+(r.getMonth()<10?"0":"")+r.getMonth()+"/"+r.getFullYear()+" at "+(r.getHours()<10?"0":"")+r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()+" --- "+Math.round(i)+" points",.5,.5,0,-60+n*20,!0)}else e.addText("No scores yet",.5,.5,0,-50,!0);e.addButton("Main menu",.5,.7,-75,0,150,30,"#BF3030",function(){e.game.popLayer()}),e.bg=new Image,e.bg.src="resources/menu.png",e.bg_width=0,e.bg_height=0,e.offx=0,e.offy=0,$(e.bg).load(function(){e.resetSize()})},drawBackground:function(){var e=this,t=e.game.context;t.drawImage(e.bg,e.offx,e.offy)},resetSize:function(e,t){var n=this,r=$(document);n.offy=r.height()/2-n.bg.height/2,n.offx=r.width()/2-n.bg.width/2}}),n}),define("game",["jquery","class","./layers/game_layer","./layers/menu_layer","./layers/menu_layers/start_menu","./layers/menu_layers/end_menu","./layers/menu_layers/scores_menu","amplify"],function(e,t,n,r,i,s,o){var u=t.create();return u.extend({layers:[]}),u.include({init:function(t){var n=this;n.focused=!1,n.debugging=!1,e("html").css("padding","0px"),e("body").css("padding","0px"),e("html").css("margin","0px"),e("body").css("margin","0px"),e("html").css("overflow","hidden"),e("body").css("overflow","hidden"),n.sound_container=e(".sound"),n.canvas=document.createElement("canvas"),n.context=n.canvas.getContext("2d"),e(n.canvas).css("background-color","black"),n.resetSize(),e(n.canvas).attr("oncontextmenu","return false;"),e(document).css("overflow","hidden"),e(window).resize(function(){n.resetSize()}),n.layers=[],e(t).append(n.canvas),n.context=n.canvas.getContext("2d"),window.mozRequestAnimationFrame?n.anfunc=window.mozRequestAnimationFrame:window.requestAnimationFrame&&(n.anfunc=window.requestAnimationFrame),n.score=0,n.startMenu(),n.current_music=0,n.music_playing=!1,n.sound_container&&n.sound_container.bind("ended",function(){n.current_music++,n.current_music%=3,n.sound_container.html('<source src="resources/music/circus_'+n.current_music+'.mp3" type="audio/mpeg">'),n.sound_container[0].volume=.2,n.sound_container[0].play()}),n.volume=.2,amplify.store("music_off")||n.startMusic()},resetSize:function(){var t=this,n=t.canvas.width,r=t.canvas.height;t.canvas.width=e(document).width(),t.canvas.height=e(window).height();var i=t.canvas.width-n,s=t.canvas.height-r;for(var o in t.layers)t.layers[o].resetSize(i,s)},startMenu:function(){var e=this;e.clearLayers();var t=i.init(e);e.addLayer(t)},scoresMenu:function(){var e=this,t=o.init(e);e.addLayer(t)},won:function(e){var t=this;t.score=e,t.running=!0;var n=s.init(t);t.addLayer(n)},lost:function(e){var t=this;t.score=0,t.lost_reason=e,t.running=!0;var n=s.init(t);t.addLayer(n)},startMusic:function(){var e=this;e.sound_container&&(e.music_playing=!0,e.sound_container.html('<source src="resources/music/circus_'+e.current_music+'.mp3" type="audio/mpeg">'),e.sound_container[0].volume=e.volume,e.sound_container[0].play(),amplify.store("music_off",!1))},volumeDown:function(){var e=this;e.volume-=.05,e.volume<0&&(e.volume=0),e.sound_container&&(e.sound_container[0].volume=e.volume)},volumeUp:function(){var e=this;e.volume+=.05,e.volume>1&&(e.volume=1),e.sound_container&&(e.sound_container[0].volume=e.volume)},stopMusic:function(){var e=this;e.sound_container&&(e.sound_container[0].pause(),e.music_playing=!1,amplify.store("music_off",!0))},newGame:function(){var e=this,t=n.init(e);e.addLayer(t)},clearLayers:function(){var e=this;e.layers=[]},addLayer:function(e){this.layers.push(e)},popLayer:function(){this.layers.pop()},animate:function(e){var t=this;setTimeout(function(){t.anfunc.call(window,t.animate.bind(t)),t.context.clearRect(0,0,t.canvas.width,t.canvas.height);for(var e in t.layers){var n=!1;e==t.layers.length-1&&(n=!0),t.layers[e].run(n)}},1)},run:function(){var e=this;e.animate()}}),u}),requirejs(["jquery","./game"],function(e,t){typeof Object.create!="function"&&(Object.create=function(e){function t(){}return t.prototype=e,new t});var n=e("#container"),r=t.init(n);r.run()}),define("main",function(){});